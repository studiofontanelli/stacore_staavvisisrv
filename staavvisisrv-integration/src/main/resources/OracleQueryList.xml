<list-query>

	<query name="it.csi.stacore.staavvisisrv.integration.dao.oracle.select.avvisoaccertamento.SelectAvvisoAccertamento">
        <body>
            <![CDATA[
					SELECT
					  AA.ID_PRATICA,
					  AA.ID_AVVISO_ACCERTAMENTO,
					  AA.ANNO_ACCERTAMENTO,
					  AA.ID_TIPO_IRREG_ACCERTAMENTO,
					  AA.ID_POSIZIONE,
					  AA.ID_CAUSALE_CHIUSURA,
					  AA.ID_SOTTOCAUSALE_CHIUSURA,
					  AA.ID_TIPO_PERIODICITA,
					  AA.ID_AVVISO_ACCERTAMENTO_ENTE,
					  AA.NUMERO_PROTOCOLLO,
					  AA.DATA_INVIO_ULTIMO_FLUSSO,
					  PCK_CONS_SERVIZI.fn_notifica_positiva(AA.ID_PRATICA) AS DATA_NOTIFICA, -- AA.DATA_NOTIFICA
					  AA.SCADENZA,
					  AA.VALIDITA,
					  AA.DATA_PAG_VERS_INSUFF,
					  AA.PROP_TIPO_PERSONA,
					  AA.PROP_COD_FISCALE,
					  AA.PROP_NOME,
					  AA.PROP_COGNOME,
					  AA.PROP_DENOMINAZIONE,
					  AA.PROP_DATA_NASCITA,
					  AA.PROP_COMUNE_NASCITA,
					  AA.PROP_COMUNE_SPEDIZIONE,
					  AA.PROP_STATO_ESTERO_NASCITA,
					  AA.PROP_PROV_SPEDIZIONE,
					  AA.PROP_SESSO,
					  AA.PROP_IND_SPEDIZIONE_NOM,
					  AA.PROP_SEDIME,
					  AA.PROP_CIVICO,
					  AA.PROP_CAP,
					  AA.VEIC_TARGA,
					  AA.VEIC_ID_TIPO_VEICOLO,
					  TV.DESCRIZIONE VEIC_DESC_TIPO_VEICOLO,
					  AA.VEIC_DATA_IMMATRIC,
					  AA.VEIC_ID_DESTINAZIONE,
					  TDEST.DESCRIZIONE VEIC_DESC_DESTINAZIONE,
					  AA.VEIC_ID_USO,
					  TU.DESCRIZIONE VEIC_DESC_USO,
					  AA.VEIC_ID_ALIMENTAZIONE,
					  TC.DESCRIZIONE VEIC_DESC_ALIMENTAZIONE,
					  AA.VEIC_FLAG_ECODIESEL,
					  AA.ID_STATO_PRATICA,
					  AA.VEIC_KW,
					  AA.STATO_NOTE,
					  AA.STATO_DATA_REGOLARIZZAZIONE,
					  AA.STATO_DESC_CAUSALE_CHIUSURA,
					  AA.STATO_DESC_SOTTOCAUSALE_CHIUSU,
					  AA.STATO_DATA1_CHIUSURA,
					  AA.STATO_DATA2_CHIUSURA,
					  AA.VERSATO_TASSA_VERSATA,
					  AA.VERSATO_SANZIONI_VERSATE,
					  AA.VERSATO_INTERESSI_VERSATI,
					  AA.VERSATO_TOTALE_VERSATO,
					  AA.DOVUTO_TASSA_ANCORA_DOVUTA,
					  (NVL(AA.DOVUTO_SANZIONI_ANCORA_DOVUTE, 0) + NVL(AA.DOVUTO_SPESE_RACC, 0)) DOVUTO_SANZIONI_ANCORA_DOVUTE,
					  AA.DOVUTO_INTERESSI_ANCORA_DOVUTI,
					  AA.DOVUTO_TOTALE_ANCORA_DOVUTO,
					  AA.DOVUTO_SEMESTRI_INTERESSI,
					  AA.RUOLO_DATA_INVIO_FLUSSO,
					  AA.CALC_TASSA_NEI_TERMINI,
					  AA.RUOLO_SEMESTRI,
					  AA.RUOLO_TASSA_ANCORA_DOVUTA,
					  DECODE((NVL(AA.RUOLO_SANZIONI_ANCORA_DOVUTE, 0) + NVL(AA.RUOLO_SPESE_RACC, 0) + NVL(AA.RUOLO_SPESE_INGIUNZ, 0)), 0, null, (NVL(AA.RUOLO_SANZIONI_ANCORA_DOVUTE, 0) + NVL(AA.RUOLO_SPESE_RACC, 0) + NVL(AA.RUOLO_SPESE_INGIUNZ, 0))) RUOLO_SANZIONI_ANCORA_DOVUTE,
					  AA.RUOLO_INTERESSI_ANCORA_DOVUTI,
					  AA.RUOLO_TOTALE_ANCORA_DOVUTO,
					  AA.DOVUTO_IMPORTO_COMPENSATO,
					  DIV.ID_DIVISA,
					  DIV.CODICE COD_DIVISA,
					  DIV.DESCRIZIONE DESC_DIVISA,
					  AAE.ID_ENTE,
					  AAE.ANNO_ACCERTAMENTO ANNO_ACCERTAMENTO_ENTE,
					  AAE.DATA_ELABORAZIONE,
					  CC.DESCRIZIONE DESC_CAUSALE_CHIUSURA,
					  CC.CODICE COD_CAUSALE_CHIUSURA,
					  SCC.DESC_SOTTOCAUSALE_CHIUSURA,
					  TP.CODICE COD_TIPO_PERIODICITA,
					  TP.DESCRIZIONE DESC_TIPO_PERIODICITA,
					  TV.ID_TIPO_VEICOLO,
					  TV.CODICE CODICE_TIPO_VEICOLO,
					  TV.DESCRIZIONE DESC_TIPO_VEICOLO,
					  TIA.DESC_TIPO_IRREG_ACCERTAMENTO,
					  TIA.CODICE CODICE_IRREG_ACCERTAMENTO,
					  SP.DESC_STATO_PRATICA,
					  AA.VEIC_MASSA_COMPLESSIVA,
					  AA.VEIC_PORTATA,
					  AA.VEIC_NUMERO_ASSI,
					  AA.VEIC_NUMERO_POSTI,
					  AA.VEIC_KW,
					  CE.DESCRIZIONE DESC_CATEGORIA_EURO,
					  TR.DESCRIZIONE VEIC_DESC_RIDUZIONE,
					  AA.VEIC_TASSA_NO_RIDUZ,
					  AA.PROP_ID_GMS,
					  TCA.CODICE COD_TIPO_COMUNICAZIONE,
					  SP.CODICE CODICE_STATO_PRATICA,
					  AA.DOVUTO_RIMORCHIABILITA,
					  AA.ID_STATO_SPEDIZIONE, AA.ID_COD_ELAB, AA.RINOTIFICA_ID_STATO, AA.RINOTIFICA_DATA_RICALC_INTERES,
					  AA.IDENTIFICATIVO_UTENTE,
					  AA.ID_CAUSALE_SOSPENSIONE,
					  CS.DESCRIZIONE DESCR_CAUSALE_SOSPENSIONE,
					  CS.CODICE COD_CAUSALE_SOSPENSIONE
					FROM
					  TAU_T_AVVISO_ACCERTAMENTO AA,
					  TAU_D_DIVISA DIV,
					  TAU_T_AVVISO_ACCERTAMENTO_ENTE AAE,
					  TAU_D_CAUSALE_CHIUSURA CC,
					  TAU_D_SOTTOCAUSALE_CHIUSURA SCC,
					  TAU_D_TIPO_PERIODICITA TP,
					  TAU_D_TIPOCOMBUSTIBILE TC,
					  TAU_D_TIPOVEICOLO TV,
					  TAU_D_TIPOUSOVEICOLO TU,
					  TAU_D_DESTINAZIONEVEICOLO TDEST,
					  TAU_D_TIPO_RIDUZIONE TR,
					  TAU_D_STATO_PRATICA SP,
					  TAU_D_TIPO_IRREG_ACCERTAMENTO TIA,
					  TAU_D_TIPO_COMUNICAZ_ACCER TCA,
					  TAU_D_CATEGORIA_EURO CE,
					  TAU_D_CAUSALE_SOSPENSIONE CS
				]]>
			</body>
	        <where>
	            <![CDATA[
				WHERE
				AA.DATA_CANCELLAZIONE IS NULL AND
	                        AA.ID_AVVISO_ACCERTAMENTO_ENTE = AAE.ID_AVVISO_ACCERTAMENTO_ENTE AND
	                        AA.ID_CAUSALE_CHIUSURA = CC.ID_CAUSALE_CHIUSURA (+) AND
	                        AA.ID_SOTTOCAUSALE_CHIUSURA = SCC.ID_SOTTOCAUSALE_CHIUSURA (+) AND
	                        AA.ID_TIPO_PERIODICITA = TP.ID_TIPO_PERIODICITA (+) AND
	                        AA.VEIC_ID_TIPO_VEICOLO = TV.ID_TIPO_VEICOLO (+) AND
	                        AA.ID_TIPO_IRREG_ACCERTAMENTO = TIA.ID_TIPO_IRREG_ACCERTAMENTO (+) AND
	                        AA.ID_TIPO_COMUNICAZ_ACCER = TCA.ID_TIPO_COMUNICAZ_ACCER (+) AND
	                        AA.VEIC_ID_CAT_EURO = CE.ID_CAT_EURO (+) AND
	                        AA.ID_TIPO_RIDUZIONE = TR.ID_TIPO_RIDUZIONE (+) AND
	                        AA.VEIC_ID_ALIMENTAZIONE = TC.ID_TIPO_COMBUSTIBILE (+) AND
	                        AA.VEIC_ID_USO = TU.ID_TIPO_USO (+) AND
	                        AA.VEIC_ID_DESTINAZIONE = TDEST.ID_DESTINAZIONE_VEICOLO (+) AND
	                        AA.ID_STATO_PRATICA = SP.ID_STATO_PRATICA AND
	                        AA.ID_CAUSALE_SOSPENSIONE = CS.ID_CAUSALE_SOSPENSIONE (+) AND
				DIV.ID_DIVISA = 1 AND AA.ID_STATO_PRATICA <> 1
		      	]]>
	            <paramWhere id="targa">AND (AA.VEIC_TARGA) = ? </paramWhere>
	            <paramWhere id="tipoVeicolo">AND AA.VEIC_ID_TIPO_VEICOLO = ? </paramWhere>
	            <paramWhere id="codiceFiscale">AND (AA.PROP_COD_FISCALE) = ? </paramWhere>
	            <paramWhere id="numeroProtocollo">AND (AA.NUMERO_PROTOCOLLO) = ? </paramWhere>
	            <paramWhere id="scadenza">AND AA.SCADENZA = ? </paramWhere>
	            <paramWhere id="validita">AND AA.VALIDITA = ? </paramWhere>
	            <paramWhere id="idAvvisoAccertamento">AND AA.ID_AVVISO_ACCERTAMENTO = ? </paramWhere>
	        </where>
    </query>
 
    

</list-query>
